<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Yolov5目标检测应用 | Chancey</title>
    <meta name="generator" content="VuePress 1.8.2">
    <link rel="icon" href="/img/blog.svg">
    <meta name="description" content="Chancey's blog, powered by VuePress, themed by Gungnir.">
    <meta name="viewport" content="width=device-width,initial-scale=1,user-scalable=no">
    
    <link rel="preload" href="https://cdn.jsdelivr.net/gh/chancey922/chancey922.github.io@main/assets/css/0.styles.f829c96e.css" as="style"><link rel="preload" href="https://cdn.jsdelivr.net/gh/chancey922/chancey922.github.io@main/assets/js/app.5d033b80.js" as="script"><link rel="preload" href="https://cdn.jsdelivr.net/gh/chancey922/chancey922.github.io@main/assets/js/8.a3610609.js" as="script"><link rel="preload" href="https://cdn.jsdelivr.net/gh/chancey922/chancey922.github.io@main/assets/js/1.73ff1d21.js" as="script"><link rel="preload" href="https://cdn.jsdelivr.net/gh/chancey922/chancey922.github.io@main/assets/js/2.da6d4541.js" as="script"><link rel="preload" href="https://cdn.jsdelivr.net/gh/chancey922/chancey922.github.io@main/assets/js/25.1d6056a4.js" as="script"><link rel="prefetch" href="https://cdn.jsdelivr.net/gh/chancey922/chancey922.github.io@main/assets/js/10.61a5cb88.js"><link rel="prefetch" href="https://cdn.jsdelivr.net/gh/chancey922/chancey922.github.io@main/assets/js/11.4f87bf4b.js"><link rel="prefetch" href="https://cdn.jsdelivr.net/gh/chancey922/chancey922.github.io@main/assets/js/12.dd603d43.js"><link rel="prefetch" href="https://cdn.jsdelivr.net/gh/chancey922/chancey922.github.io@main/assets/js/13.6fdb6aae.js"><link rel="prefetch" href="https://cdn.jsdelivr.net/gh/chancey922/chancey922.github.io@main/assets/js/14.2e5939b7.js"><link rel="prefetch" href="https://cdn.jsdelivr.net/gh/chancey922/chancey922.github.io@main/assets/js/15.9ae544c7.js"><link rel="prefetch" href="https://cdn.jsdelivr.net/gh/chancey922/chancey922.github.io@main/assets/js/16.151d317f.js"><link rel="prefetch" href="https://cdn.jsdelivr.net/gh/chancey922/chancey922.github.io@main/assets/js/17.33f0c868.js"><link rel="prefetch" href="https://cdn.jsdelivr.net/gh/chancey922/chancey922.github.io@main/assets/js/18.1537f48f.js"><link rel="prefetch" href="https://cdn.jsdelivr.net/gh/chancey922/chancey922.github.io@main/assets/js/19.6883b32b.js"><link rel="prefetch" href="https://cdn.jsdelivr.net/gh/chancey922/chancey922.github.io@main/assets/js/20.63a017ed.js"><link rel="prefetch" href="https://cdn.jsdelivr.net/gh/chancey922/chancey922.github.io@main/assets/js/21.c9771b43.js"><link rel="prefetch" href="https://cdn.jsdelivr.net/gh/chancey922/chancey922.github.io@main/assets/js/22.6bd676f8.js"><link rel="prefetch" href="https://cdn.jsdelivr.net/gh/chancey922/chancey922.github.io@main/assets/js/23.7a8a5b12.js"><link rel="prefetch" href="https://cdn.jsdelivr.net/gh/chancey922/chancey922.github.io@main/assets/js/24.4b4f85f5.js"><link rel="prefetch" href="https://cdn.jsdelivr.net/gh/chancey922/chancey922.github.io@main/assets/js/26.24384ac6.js"><link rel="prefetch" href="https://cdn.jsdelivr.net/gh/chancey922/chancey922.github.io@main/assets/js/27.511f548e.js"><link rel="prefetch" href="https://cdn.jsdelivr.net/gh/chancey922/chancey922.github.io@main/assets/js/28.cc11bd29.js"><link rel="prefetch" href="https://cdn.jsdelivr.net/gh/chancey922/chancey922.github.io@main/assets/js/29.08632562.js"><link rel="prefetch" href="https://cdn.jsdelivr.net/gh/chancey922/chancey922.github.io@main/assets/js/30.47500f86.js"><link rel="prefetch" href="https://cdn.jsdelivr.net/gh/chancey922/chancey922.github.io@main/assets/js/4.751f0196.js"><link rel="prefetch" href="https://cdn.jsdelivr.net/gh/chancey922/chancey922.github.io@main/assets/js/5.4f2f791c.js"><link rel="prefetch" href="https://cdn.jsdelivr.net/gh/chancey922/chancey922.github.io@main/assets/js/6.7a782861.js"><link rel="prefetch" href="https://cdn.jsdelivr.net/gh/chancey922/chancey922.github.io@main/assets/js/7.8312c856.js"><link rel="prefetch" href="https://cdn.jsdelivr.net/gh/chancey922/chancey922.github.io@main/assets/js/9.0a8ec73e.js">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/chancey922/chancey922.github.io@main/assets/css/0.styles.f829c96e.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div id="theme-container" class="theme-container post-container no-sidebar" data-v-422e6324><header class="navbar invert" data-v-422e6324><a href="/" class="home-link router-link-active"><span class="site-name"> $ cd /home/ </span></a> <div class="links"><nav class="nav-links can-hide"><div class="nav-item"><a href="/" class="nav-link ov-parent ov-hover"><svg aria-hidden="true" width="19.2" height="19.2" viewBox="-43.52 -43.52 599.04 599.04" fill="currentColor" class="ov-icon ov-wrench ov-hover" style="font-size:1.2em;"><path d="M489.2 287.9h-27.4c-2.6 0-4.6 2-4.6 4.6v32h-36.6V146.2c0-2.6-2-4.6-4.6-4.6h-27.4c-2.6 0-4.6 2-4.6 4.6v32h-36.6v-32c0-2.6-2-4.6-4.6-4.6h-27.4c-2.6 0-4.6 2-4.6 4.6v32h-36.6v-32c0-6-8-4.6-11.7-4.6v-38c8.3-2 17.1-3.4 25.7-3.4 10.9 0 20.9 4.3 31.4 4.3 4.6 0 27.7-1.1 27.7-8v-60c0-2.6-2-4.6-4.6-4.6-5.1 0-15.1 4.3-24 4.3-9.7 0-20.9-4.3-32.6-4.3-8 0-16 1.1-23.7 2.9v-4.9c5.4-2.6 9.1-8.3 9.1-14.3 0-20.7-31.4-20.8-31.4 0 0 6 3.7 11.7 9.1 14.3v111.7c-3.7 0-11.7-1.4-11.7 4.6v32h-36.6v-32c0-2.6-2-4.6-4.6-4.6h-27.4c-2.6 0-4.6 2-4.6 4.6v32H128v-32c0-2.6-2-4.6-4.6-4.6H96c-2.6 0-4.6 2-4.6 4.6v178.3H54.8v-32c0-2.6-2-4.6-4.6-4.6H22.8c-2.6 0-4.6 2-4.6 4.6V512h182.9v-96c0-72.6 109.7-72.6 109.7 0v96h182.9V292.5c.1-2.6-1.9-4.6-4.5-4.6zm-288.1-4.5c0 2.6-2 4.6-4.6 4.6h-27.4c-2.6 0-4.6-2-4.6-4.6v-64c0-2.6 2-4.6 4.6-4.6h27.4c2.6 0 4.6 2 4.6 4.6v64zm146.4 0c0 2.6-2 4.6-4.6 4.6h-27.4c-2.6 0-4.6-2-4.6-4.6v-64c0-2.6 2-4.6 4.6-4.6h27.4c2.6 0 4.6 2 4.6 4.6v64z"/></svg>
  主页
</a></div><div class="nav-item"><a href="/about/" class="nav-link ov-parent ov-hover"><svg aria-hidden="true" width="19.2" height="19.2" viewBox="-51.52 -43.52 599.04 599.04" fill="currentColor" class="ov-icon ov-wrench ov-hover" style="font-size:1.2em;"><path d="M248 8C111 8 0 119 0 256s111 248 248 248 248-111 248-248S385 8 248 8zm0 96c48.6 0 88 39.4 88 88s-39.4 88-88 88-88-39.4-88-88 39.4-88 88-88zm0 344c-58.7 0-111.3-26.6-146.5-68.2 18.8-35.4 55.6-59.8 98.5-59.8 2.4 0 4.8.4 7.1 1.1 13 4.2 26.6 6.9 40.9 6.9 14.3 0 28-2.7 40.9-6.9 2.3-.7 4.7-1.1 7.1-1.1 42.9 0 79.7 24.4 98.5 59.8C359.3 421.4 306.7 448 248 448z"/></svg>
  简介
</a></div><div class="nav-item"><a href="/tags/" class="nav-link ov-parent ov-hover"><svg aria-hidden="true" width="19.2" height="19.2" viewBox="-43.52 -43.52 599.04 599.04" fill="currentColor" class="ov-icon ov-wrench ov-hover" style="font-size:1.2em;"><path d="M0 252.118V48C0 21.49 21.49 0 48 0h204.118a48 48 0 0133.941 14.059l211.882 211.882c18.745 18.745 18.745 49.137 0 67.882L293.823 497.941c-18.745 18.745-49.137 18.745-67.882 0L14.059 286.059A48 48 0 010 252.118zM112 64c-26.51 0-48 21.49-48 48s21.49 48 48 48 48-21.49 48-48-21.49-48-48-48z"/></svg>
  归档
</a></div><div class="nav-item"><a href="/projects/" class="nav-link ov-parent ov-hover"><svg aria-hidden="true" width="19.2" height="19.2" viewBox="-43.52 -43.52 599.04 599.04" fill="currentColor" class="ov-icon ov-wrench ov-hover" style="font-size:1.2em;"><path d="M48 48a48 48 0 1048 48 48 48 0 00-48-48zm0 160a48 48 0 1048 48 48 48 0 00-48-48zm0 160a48 48 0 1048 48 48 48 0 00-48-48zm448 16H176a16 16 0 00-16 16v32a16 16 0 0016 16h320a16 16 0 0016-16v-32a16 16 0 00-16-16zm0-320H176a16 16 0 00-16 16v32a16 16 0 0016 16h320a16 16 0 0016-16V80a16 16 0 00-16-16zm0 160H176a16 16 0 00-16 16v32a16 16 0 0016 16h320a16 16 0 0016-16v-32a16 16 0 00-16-16z"/></svg>
  项目
</a></div> <div class="nav-item"><a class="nav-link ov-parent ov-hover" style="cursor: pointer"><svg aria-hidden="true" width="19.2" height="19.2" viewBox="0 0 24 24" fill="currentColor" class="ov-icon ov-wrench ov-hover" style="font-size:1.2em;"><path fill="none" d="M0 0h24v24H0z"/><path d="M11 2c4.968 0 9 4.032 9 9s-4.032 9-9 9-9-4.032-9-9 4.032-9 9-9zm0 16c3.867 0 7-3.133 7-7 0-3.868-3.133-7-7-7-3.868 0-7 3.132-7 7 0 3.867 3.132 7 7 7zm8.485.071l2.829 2.828-1.415 1.415-2.828-2.829 1.414-1.414z"/></svg>
      Search
    </a></div></nav></div></header> <div class="sidebar-mask" data-v-422e6324></div> <aside class="sidebar" data-v-422e6324><div class="personal-info-wrapper" data-v-422e6324><div class="mobile-hero-avatar" data-v-422e6324><img src="/img/avatar.png" alt="hero" data-v-422e6324></div> <p class="mobile-heading" data-v-422e6324>
          Chancey
        </p> <div class="sns-wrapper" data-v-422e6324><a href="https://github.com/chancey922" target="_blank" rel="noopener noreferrer"><svg aria-hidden="true" width="0" height="0" viewBox="0 0 0 0" fill="currentColor" class="icon-stack ov-icon" style="font-size:1.2em;"><!----> <svg aria-hidden="true" width="19.2" height="19.2" viewBox="-59.52 -43.52 599.04 599.04" fill="currentColor" class="icon-sns ov-icon ov-inverse" style="font-size:1.2em;"><path d="M186.1 328.7c0 20.9-10.9 55.1-36.7 55.1s-36.7-34.2-36.7-55.1 10.9-55.1 36.7-55.1 36.7 34.2 36.7 55.1zM480 278.2c0 31.9-3.2 65.7-17.5 95-37.9 76.6-142.1 74.8-216.7 74.8-75.8 0-186.2 2.7-225.6-74.8-14.6-29-20.2-63.1-20.2-95 0-41.9 13.9-81.5 41.5-113.6-5.2-15.8-7.7-32.4-7.7-48.8 0-21.5 4.9-32.3 14.6-51.8 45.3 0 74.3 9 108.8 36 29-6.9 58.8-10 88.7-10 27 0 54.2 2.9 80.4 9.2 34-26.7 63-35.2 107.8-35.2 9.8 19.5 14.6 30.3 14.6 51.8 0 16.4-2.6 32.7-7.7 48.2 27.5 32.4 39 72.3 39 114.2zm-64.3 50.5c0-43.9-26.7-82.6-73.5-82.6-18.9 0-37 3.4-56 6-14.9 2.3-29.8 3.2-45.1 3.2-15.2 0-30.1-.9-45.1-3.2-18.7-2.6-37-6-56-6-46.8 0-73.5 38.7-73.5 82.6 0 87.8 80.4 101.3 150.4 101.3h48.2c70.3 0 150.6-13.4 150.6-101.3zm-82.6-55.1c-25.8 0-36.7 34.2-36.7 55.1s10.9 55.1 36.7 55.1 36.7-34.2 36.7-55.1-10.9-55.1-36.7-55.1z"/></svg></svg></a><a href="mailto:505585725@qq.com" target="_blank" rel="noopener noreferrer"><svg aria-hidden="true" width="0" height="0" viewBox="0 0 0 0" fill="currentColor" class="icon-stack ov-icon" style="font-size:1.2em;"><!----> <svg aria-hidden="true" width="19.2" height="19.2" viewBox="-43.52 -43.52 599.04 599.04" fill="currentColor" class="icon-sns ov-icon ov-inverse" style="font-size:1.2em;"><path d="M502.3 190.8c3.9-3.1 9.7-.2 9.7 4.7V400c0 26.5-21.5 48-48 48H48c-26.5 0-48-21.5-48-48V195.6c0-5 5.7-7.8 9.7-4.7 22.4 17.4 52.1 39.5 154.1 113.6 21.1 15.4 56.7 47.8 92.2 47.6 35.7.3 72-32.8 92.3-47.6 102-74.1 131.6-96.3 154-113.7zM256 320c23.2.4 56.6-29.2 73.4-41.4 132.7-96.3 142.8-104.7 173.4-128.7 5.8-4.5 9.2-11.5 9.2-18.9v-19c0-26.5-21.5-48-48-48H48C21.5 64 0 85.5 0 112v19c0 7.4 3.4 14.3 9.2 18.9 30.6 23.9 40.7 32.4 173.4 128.7 16.8 12.2 50.2 41.8 73.4 41.4z"/></svg></svg></a>  <!----></div> <hr data-v-422e6324></div> <nav class="nav-links"><div class="nav-item"><a href="/" class="nav-link ov-parent ov-hover"><svg aria-hidden="true" width="19.2" height="19.2" viewBox="-43.52 -43.52 599.04 599.04" fill="currentColor" class="ov-icon ov-wrench ov-hover" style="font-size:1.2em;"><path d="M489.2 287.9h-27.4c-2.6 0-4.6 2-4.6 4.6v32h-36.6V146.2c0-2.6-2-4.6-4.6-4.6h-27.4c-2.6 0-4.6 2-4.6 4.6v32h-36.6v-32c0-2.6-2-4.6-4.6-4.6h-27.4c-2.6 0-4.6 2-4.6 4.6v32h-36.6v-32c0-6-8-4.6-11.7-4.6v-38c8.3-2 17.1-3.4 25.7-3.4 10.9 0 20.9 4.3 31.4 4.3 4.6 0 27.7-1.1 27.7-8v-60c0-2.6-2-4.6-4.6-4.6-5.1 0-15.1 4.3-24 4.3-9.7 0-20.9-4.3-32.6-4.3-8 0-16 1.1-23.7 2.9v-4.9c5.4-2.6 9.1-8.3 9.1-14.3 0-20.7-31.4-20.8-31.4 0 0 6 3.7 11.7 9.1 14.3v111.7c-3.7 0-11.7-1.4-11.7 4.6v32h-36.6v-32c0-2.6-2-4.6-4.6-4.6h-27.4c-2.6 0-4.6 2-4.6 4.6v32H128v-32c0-2.6-2-4.6-4.6-4.6H96c-2.6 0-4.6 2-4.6 4.6v178.3H54.8v-32c0-2.6-2-4.6-4.6-4.6H22.8c-2.6 0-4.6 2-4.6 4.6V512h182.9v-96c0-72.6 109.7-72.6 109.7 0v96h182.9V292.5c.1-2.6-1.9-4.6-4.5-4.6zm-288.1-4.5c0 2.6-2 4.6-4.6 4.6h-27.4c-2.6 0-4.6-2-4.6-4.6v-64c0-2.6 2-4.6 4.6-4.6h27.4c2.6 0 4.6 2 4.6 4.6v64zm146.4 0c0 2.6-2 4.6-4.6 4.6h-27.4c-2.6 0-4.6-2-4.6-4.6v-64c0-2.6 2-4.6 4.6-4.6h27.4c2.6 0 4.6 2 4.6 4.6v64z"/></svg>
  主页
</a></div><div class="nav-item"><a href="/about/" class="nav-link ov-parent ov-hover"><svg aria-hidden="true" width="19.2" height="19.2" viewBox="-51.52 -43.52 599.04 599.04" fill="currentColor" class="ov-icon ov-wrench ov-hover" style="font-size:1.2em;"><path d="M248 8C111 8 0 119 0 256s111 248 248 248 248-111 248-248S385 8 248 8zm0 96c48.6 0 88 39.4 88 88s-39.4 88-88 88-88-39.4-88-88 39.4-88 88-88zm0 344c-58.7 0-111.3-26.6-146.5-68.2 18.8-35.4 55.6-59.8 98.5-59.8 2.4 0 4.8.4 7.1 1.1 13 4.2 26.6 6.9 40.9 6.9 14.3 0 28-2.7 40.9-6.9 2.3-.7 4.7-1.1 7.1-1.1 42.9 0 79.7 24.4 98.5 59.8C359.3 421.4 306.7 448 248 448z"/></svg>
  简介
</a></div><div class="nav-item"><a href="/tags/" class="nav-link ov-parent ov-hover"><svg aria-hidden="true" width="19.2" height="19.2" viewBox="-43.52 -43.52 599.04 599.04" fill="currentColor" class="ov-icon ov-wrench ov-hover" style="font-size:1.2em;"><path d="M0 252.118V48C0 21.49 21.49 0 48 0h204.118a48 48 0 0133.941 14.059l211.882 211.882c18.745 18.745 18.745 49.137 0 67.882L293.823 497.941c-18.745 18.745-49.137 18.745-67.882 0L14.059 286.059A48 48 0 010 252.118zM112 64c-26.51 0-48 21.49-48 48s21.49 48 48 48 48-21.49 48-48-21.49-48-48-48z"/></svg>
  归档
</a></div><div class="nav-item"><a href="/projects/" class="nav-link ov-parent ov-hover"><svg aria-hidden="true" width="19.2" height="19.2" viewBox="-43.52 -43.52 599.04 599.04" fill="currentColor" class="ov-icon ov-wrench ov-hover" style="font-size:1.2em;"><path d="M48 48a48 48 0 1048 48 48 48 0 00-48-48zm0 160a48 48 0 1048 48 48 48 0 00-48-48zm0 160a48 48 0 1048 48 48 48 0 00-48-48zm448 16H176a16 16 0 00-16 16v32a16 16 0 0016 16h320a16 16 0 0016-16v-32a16 16 0 00-16-16zm0-320H176a16 16 0 00-16 16v32a16 16 0 0016 16h320a16 16 0 0016-16V80a16 16 0 00-16-16zm0 160H176a16 16 0 00-16 16v32a16 16 0 0016 16h320a16 16 0 0016-16v-32a16 16 0 00-16-16z"/></svg>
  项目
</a></div> <div class="nav-item"><a class="nav-link ov-parent ov-hover" style="cursor: pointer"><svg aria-hidden="true" width="19.2" height="19.2" viewBox="0 0 24 24" fill="currentColor" class="ov-icon ov-wrench ov-hover" style="font-size:1.2em;"><path fill="none" d="M0 0h24v24H0z"/><path d="M11 2c4.968 0 9 4.032 9 9s-4.032 9-9 9-9-4.032-9-9 4.032-9 9-9zm0 16c3.867 0 7-3.133 7-7 0-3.868-3.133-7-7-7-3.868 0-7 3.132-7 7 0 3.867 3.132 7 7 7zm8.485.071l2.829 2.828-1.415 1.415-2.828-2.829 1.414-1.414z"/></svg>
      Search
    </a></div></nav> <!----> </aside> <div class="content" data-v-422e6324><div class="post-header" data-v-2c97064e> <div class="header-content" data-v-2c97064e><div class="tags" data-v-2c97064e><span class="tag" data-v-2c97064e>
        机器学习
      </span><span class="tag" data-v-2c97064e>
        目标检测
      </span><span class="tag" data-v-2c97064e>
        工程实践
      </span></div> <h1 class="title" data-v-2c97064e>
      Yolov5目标检测应用
    </h1> <h3 class="subtitle" data-v-2c97064e>
      基于Colab平台检测刀剑数据集
    </h3> <div class="icons" data-v-2c97064e><div class="icon" data-v-2c97064e><svg aria-hidden="true" width="19.2" height="19.2" viewBox="-75.52 -43.52 599.04 599.04" fill="currentColor" class="ov-icon" style="font-size:1.2em;" data-v-2c97064e><path d="M313.6 304c-28.7 0-42.5 16-89.6 16-47.1 0-60.8-16-89.6-16C60.2 304 0 364.2 0 438.4V464c0 26.5 21.5 48 48 48h352c26.5 0 48-21.5 48-48v-25.6c0-74.2-60.2-134.4-134.4-134.4zM400 464H48v-25.6c0-47.6 38.8-86.4 86.4-86.4 14.6 0 38.3 16 89.6 16 51.7 0 74.9-16 89.6-16 47.6 0 86.4 38.8 86.4 86.4V464zM224 288c79.5 0 144-64.5 144-144S303.5 0 224 0 80 64.5 80 144s64.5 144 144 144zm0-240c52.9 0 96 43.1 96 96s-43.1 96-96 96-96-43.1-96-96 43.1-96 96-96z"/></svg> <span data-v-2c97064e>Chancey</span></div> <div class="icon" data-v-2c97064e><svg aria-hidden="true" width="19.2" height="19.2" viewBox="-75.52 -43.52 599.04 599.04" fill="currentColor" class="ov-icon" style="font-size:1.2em;" data-v-2c97064e><path d="M400 64h-48V12c0-6.6-5.4-12-12-12h-40c-6.6 0-12 5.4-12 12v52H160V12c0-6.6-5.4-12-12-12h-40c-6.6 0-12 5.4-12 12v52H48C21.5 64 0 85.5 0 112v352c0 26.5 21.5 48 48 48h352c26.5 0 48-21.5 48-48V112c0-26.5-21.5-48-48-48zm-6 400H54c-3.3 0-6-2.7-6-6V160h352v298c0 3.3-2.7 6-6 6z"/></svg> <span data-v-2c97064e>2021-07-04</span></div> <div class="icon" data-v-2c97064e><svg aria-hidden="true" width="19.2" height="19.2" viewBox="0 0 24 24" fill="currentColor" class="ov-icon" style="font-size:1.2em;" data-v-2c97064e><path fill="none" d="M0 0h24v24H0z"/><path d="M17.618 5.968l1.453-1.453 1.414 1.414-1.453 1.453a9 9 0 11-1.414-1.414zM12 20a7 7 0 100-14 7 7 0 000 14zM11 8h2v6h-2V8zM8 1h8v2H8V1z"/></svg> <span data-v-2c97064e>24 min</span></div></div></div></div> <main class="page"><!----> <div class="theme-content content__default"><h1 id="基于colab和yolov5框架进行枪-剑目标检测"><a href="#基于colab和yolov5框架进行枪-剑目标检测" class="header-anchor">#</a> 基于Colab和Yolov5框架进行枪&amp;剑目标检测</h1> <img src="http://test-123-imagebed.oss-cn-beijing.aliyuncs.com/img/image-20210703213751655.png" alt="image-20210703213751655" style="zoom:50%;"> <h2 id="任务概述"><a href="#任务概述" class="header-anchor">#</a> 任务概述</h2> <p>本次的任务：<strong>用 gun/sword 数据集训练你的物体检测模型，并对数据集中的验证集进行检测，计算出 mAP</strong>。</p> <p>任务分解为：</p> <ul><li>选择模型</li> <li>配置环境</li> <li>制作数据集</li> <li>构建模型</li> <li>训练模型</li> <li>评估模型</li> <li>优化和部署模型（可选）</li></ul> <p>Yolov5模型训练部分参考Yolov5官方的<a href="https://github.com/ultralytics/yolov5/wiki/Train-Custom-Data" target="_blank" rel="noopener noreferrer">Train Custom Data文档</a>、<a href="https://colab.research.google.com/github/ultralytics/yolov5/blob/master/tutorial.ipynb" target="_blank" rel="noopener noreferrer">官方Colab笔记本</a>、<a href="https://blog.roboflow.com/how-to-train-yolov5-on-a-custom-dataset/" target="_blank" rel="noopener noreferrer">Roboflow的Yolov5训练博客</a>、<a href="https://zhuanlan.zhihu.com/p/161778675" target="_blank" rel="noopener noreferrer">知乎：使用Yolov5进行端到端目标检测</a>以及Harryee同学的<a href="https://github.com/Harryee/yolov5_homework/blob/main/readme.md" target="_blank" rel="noopener noreferrer">使用文档</a>。wandb的使用参考了wandb官网<a href="https://wandb.ai/cayush/yolov5-dsviz-demo/reports/Object-Detection-with-YOLO-and-Weights-Biases--Vmlldzo0NTgzMjk" target="_blank" rel="noopener noreferrer">介绍</a>和wandb官方的<a href="https://colab.research.google.com/drive/1CRC7kxYTIQQysowbrT2L6ctPen6ZQVeN?usp=sharing" target="_blank" rel="noopener noreferrer">colab演示笔记本</a>。</p> <p>Colab笔记地址： <a href="https://colab.research.google.com/drive/1Dwe00BGNNSOVaAXiXiW8GR9OJtpzF6Jc?usp=sharing" target="_blank" rel="noopener noreferrer"><img src="http://test-123-imagebed.oss-cn-beijing.aliyuncs.com/img/image-20210703223053458.png" alt="image-20210703223053458"></a></p> <p>该项目的wandb形成报告：https://wandb.ai/chancey/yolo-wandb-gw-detect/reports/---Vmlldzo4MjE0NzU</p> <p>wandb地址：https://wandb.ai/chancey/yolo-wandb-gw-detect/overview?workspace=user-chancey</p> <h2 id="选择模型"><a href="#选择模型" class="header-anchor">#</a> 选择模型</h2> <p>目标检测的常用模型有Faster R-CNN、SSD和YOLO，在这里使用了Yolo家族的Yolov5作为模型框架。YOLOv5并不是一个单独的模型，而是一个模型家族，包括了YOLOv5s(最小)、YOLOv5m、YOLOv5l、YOLOv5x(最大)。</p> <p><img src="https://github.com/ultralytics/yolov5/releases/download/v1.0/model_comparison.png" alt="YOLOv5 模型"></p> <blockquote><p>图片来源：https://github.com/ultralytics/yolov5</p></blockquote> <p>由于YOLOv5是在PyTorch中实现的，它受益于成熟的PyTorch生态系统，支持更简单，部署更容易，相对于YOLOv4，YOLOv5具有以下优点：</p> <ul><li><p>速度更快</p></li> <li><p>精度更高</p></li></ul> <h2 id="配置环境"><a href="#配置环境" class="header-anchor">#</a> 配置环境</h2> <p>Yolov5可以在windows，macOX，Linux（只要依赖项CUDA/CUDNN、Python和PyTorch都已预装）下运行，然后也可以在一些云平台运行，例如kaggle，colab，亚马逊的AWS和谷歌的GCP。这里使用colab作为环境（因为可以白嫖Tesla T4）。</p> <h2 id="数据收集"><a href="#数据收集" class="header-anchor">#</a> 数据收集</h2> <p><strong>收集的主要途径：</strong></p> <ul><li>公用的数据集</li> <li>github中去找相似的项目</li> <li>爬虫去网站上爬取</li> <li>自行制作</li></ul> <p>有时我们可以在网上下载到别人已经训练好的模型，比如下载动物识别的模型，用这个模型去检测我们数据集中的图片，就可以自动生成label,后续只要在模型预测的label的基础上进行调整和增加即可，大大减少了工作量。</p> <p>在这里我们使用vott自行制作枪🔫&amp;剑🗡数据集。具体方法不再叙述。<a href="https://zhuanlan.zhihu.com/p/161778675" target="_blank" rel="noopener noreferrer">知乎：使用Yolov5进行端到端目标检测</a>中推荐了一个叫Hyperlabel的工具，可以导出多种格式。</p> <p><img src="http://test-123-imagebed.oss-cn-beijing.aliyuncs.com/img/v2-dee4158296cb386f198113bcda87196e_720w.jpg" alt="img"></p> <p>在这里，需要补充yolov5的文件格式要求。</p> <h3 id="yolov5的数据格式要求"><a href="#yolov5的数据格式要求" class="header-anchor">#</a> Yolov5的数据格式要求</h3> <h4 id="单个数据"><a href="#单个数据" class="header-anchor">#</a> 单个数据</h4> <p>将标签导出为<strong>YOLO 格式</strong>，每个图像各有一个<code>*.txt</code>文件</p> <ul><li>每个对象一行</li> <li>每一行都是<code>class x_center y_center width height</code>格式。</li> <li>框坐标必须采用<strong>标准化 xywh</strong>格式（从 0 - 1）。如果您的箱子以像素为单位，划分<code>x_center</code>并<code>width</code>通过图像宽度，<code>y_center</code>并<code>height</code>通过图像高度。</li> <li>类号是零索引的（从 0 开始）</li></ul> <p><img src="http://test-123-imagebed.oss-cn-beijing.aliyuncs.com/img/91506361-c7965000-e886-11ea-8291-c72b98c25eec.jpg" alt="Image Labels"></p> <blockquote><p>图片来源：https://github.com/ultralytics/yolov5/wiki/Train-Custom-Data</p></blockquote> <h4 id="数据集"><a href="#数据集" class="header-anchor">#</a> 数据集</h4> <p>yolo训练需要将将训练、验证、测试数据按照图像和标注文件统一到image和labels文件夹中。以下是官方给的数据准备结构。</p> <p><img src="http://test-123-imagebed.oss-cn-beijing.aliyuncs.com/img/20210308142226328.jpg" alt="在这里插入图片描述"></p> <blockquote><p>图片来源：https://github.com/ultralytics/yolov5/wiki/Train-Custom-Data</p></blockquote> <div class="language- extra-class"><pre class="language-text"><code>├── data
│   ├── Annotations  进行 detection 任务时的标签文件，xml 形式，文件名与图片名一一对应
│   ├── images  存放 .jpg 格式的图片文件
│   ├── ImageSets  存放的是分类和检测的数据集分割文件，包含train.txt, val.txt,trainval.txt,test.txt
│   ├── labels  存放label标注信息的txt文件，与图片一一对应


├── ImageSets(train，val，test建议按照8：1：1比例划分)
│   ├── train.txt  写着用于训练的图片名称
│   ├── val.txt  写着用于验证的图片名称
│   ├── trainval.txt  train与val的合集
│   ├── test.txt  写着用于测试的图片名称
</code></pre></div><p>如果需要将voc等格式转换为Yolov5格式的话，可以参考这篇博客：<a href="https://blog.csdn.net/tpz789/article/details/110675268" target="_blank" rel="noopener noreferrer">CSDN：yolov5训练自己的数据集并计算mAP</a>其中的<code>voc_label.py</code>。</p> <h2 id="yolov5的配置文件yaml"><a href="#yolov5的配置文件yaml" class="header-anchor">#</a> yolov5的配置文件<code>yaml</code></h2> <p>训练模型之前需要了解yolov5的核心配置文件，<code>*.yaml</code>，Yolov5可以通过命令行配置<code>*.yaml</code>来进行模型参数的修改，这是和Yolov4的一个区别，提高了使用的简易性。</p> <ul><li>YAML(YAML Ain`t Markup language)文件，它不是一个标记语言。配置文件有xml、properties等，但YAML是以数据为中心，更适合做配置文件。</li> <li>YAML的语法和其他高级语言类似，并且可以简单表达清单、散列表，标量等数据形态。</li> <li>它使用空白符号缩进和大量依赖外观的特色，特别适合用来表达或编辑数据结构、各种配置文件、倾印调试内容、文件大纲。yaml介绍</li> <li>大小写敏感；缩进不允许使用tab，只允许空格；缩进的空格数不重要，只要相同层级的元素左对齐即可；’#'表示注释；使用缩进表示层级关系。</li></ul> <p>Yolov5的配置文件为<code>yaml</code>类型，<code>*.yaml</code>文件通过<code>yolo.py</code>解析文件配置模型的网络结构。yaml文件配置网络的好处是十分的方便不需要像Yolov3的config设置网络一样进行叠加，只需要在yaml配置文件中的参数进行修改即可。</p> <p>这样做的好处是可以通过这两个参数控制网络的宽度和深度，实现不同大小不同复杂度的模型设计，但是这种写法缺点是不再能直接采用第三方工具例如netron进行网络模型可视化。</p> <h3 id="yaml里有什么"><a href="#yaml里有什么" class="header-anchor">#</a> yaml里有什么</h3> <p>为了更好的了解和修改yolov5的配置文件,这里以<a href="https://github.com/ultralytics/yolov5/blob/master/models/yolov5s.yaml" target="_blank" rel="noopener noreferrer"><strong>Yolov5s.yaml</strong></a>为例，文件内共分为四个部分。</p> <p>yolov5提供了s、m、l、x四种，所有的yaml文件都设置差不多，只有上面2和3的设置不同，作者团队很厉害，只需要修改这两个参数就可以调整模型的网络结构。</p> <p><img src="http://test-123-imagebed.oss-cn-beijing.aliyuncs.com/img/114313216-f0a5e100-9af5-11eb-8445-c682b60da2e3.png" alt="img"></p> <h4 id="parameters"><a href="#parameters" class="header-anchor">#</a> parameters</h4> <p>负责模型的深度和宽度</p> <div class="language-yaml extra-class"><pre class="language-yaml"><code><span class="token comment"># parameters  </span>
<span class="token key atrule">nc</span><span class="token punctuation">:</span> <span class="token number">80</span>  <span class="token comment"># number of classes  </span>
<span class="token key atrule">depth_multiple</span><span class="token punctuation">:</span> <span class="token number">0.33</span>  <span class="token comment"># model depth multiple  </span>
<span class="token key atrule">width_multiple</span><span class="token punctuation">:</span> <span class="token number">0.50</span>  <span class="token comment"># layer channel multiple  </span>
</code></pre></div><p><code>nc</code>：目标的类别数量。</p> <p><code>depth_multiple</code>：模型深度 控制模块的数量，当模块的数量number不为1时，模块的数量 = number * depth。</p> <p><code>width_multiple</code>：模型的宽度 控制卷积核的数量 ，卷积核的数量 = 数量 * width。</p> <blockquote><p>depth_multiple 是用在backbone中的number≠1的情况下， 即在Bottleneck层使用，控制模型的深度，yolov5s中设置为0.33，假设yolov5l中有三个Bottleneck，那yolov5s中就只有一个Bottleneck。
因为一般number=1表示的是功能背景的层，比如说下采样Conv、Focus、SPP（空间金字塔池化）。</p> <p>width_multiple 主要是用于设置arguments，例如yolov5s设置为0.5，Focus就变成[32, 3]，Conv就变成[64, 3, 2]。
以此类推，卷积核的个数都变成了设置的一半。</p></blockquote> <h4 id="acnhor"><a href="#acnhor" class="header-anchor">#</a> Acnhor</h4> <div class="language-yaml extra-class"><pre class="language-yaml"><code><span class="token comment"># anchors  </span>
<span class="token key atrule">anchors</span><span class="token punctuation">:</span>  
  <span class="token punctuation">-</span> <span class="token punctuation">[</span><span class="token number">10</span><span class="token punctuation">,</span><span class="token number">13</span><span class="token punctuation">,</span> <span class="token number">16</span><span class="token punctuation">,</span><span class="token number">30</span><span class="token punctuation">,</span> <span class="token number">33</span><span class="token punctuation">,</span><span class="token number">23</span><span class="token punctuation">]</span>  <span class="token comment"># P3/8  检测小目标  10，13是一组尺寸，一共三组  </span>
  <span class="token punctuation">-</span> <span class="token punctuation">[</span><span class="token number">30</span><span class="token punctuation">,</span><span class="token number">61</span><span class="token punctuation">,</span> <span class="token number">62</span><span class="token punctuation">,</span><span class="token number">45</span><span class="token punctuation">,</span> <span class="token number">59</span><span class="token punctuation">,</span><span class="token number">119</span><span class="token punctuation">]</span>  <span class="token comment"># P4/16     </span>
  <span class="token punctuation">-</span> <span class="token punctuation">[</span><span class="token number">116</span><span class="token punctuation">,</span><span class="token number">90</span><span class="token punctuation">,</span> <span class="token number">156</span><span class="token punctuation">,</span><span class="token number">198</span><span class="token punctuation">,</span> <span class="token number">373</span><span class="token punctuation">,</span><span class="token number">326</span><span class="token punctuation">]</span>  <span class="token comment"># P5/32  检测大目标  </span>
</code></pre></div><p>yolov5已经在yaml预设好了输入图像为640*640分辨率对应的anchor尺寸，yolov5的anchor也是在大特征图上检测小目标，在小特征图上检测大目标。三个特征图，每个特征图上的格子有三种尺寸的anchor。</p> <h4 id="backbone"><a href="#backbone" class="header-anchor">#</a> Backbone</h4> <div class="language-yaml extra-class"><pre class="language-yaml"><code><span class="token comment"># YOLOv5 backbone  </span>
<span class="token key atrule">backbone</span><span class="token punctuation">:</span>  
  <span class="token comment"># from   第一列 输入来自哪一层  -1代表上一层，-2表示从上两层获得的输入， 4代表第4层     </span>
  <span class="token comment"># number 第二列 卷积核的数量    最终数量需要乘上width  1表示只有一个，3表示有三个相同的模块</span>
  <span class="token comment"># module 第三列 模块名称 包括：Conv Focus BottleneckCSP  SPP  </span>
  <span class="token comment"># args   第四列 模块的参数   </span>
  <span class="token comment"># [from, number, module, args]  </span>
  <span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token number">-1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> Focus<span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token number">64</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">,</span>  <span class="token comment"># 0-P1/2  </span>
   <span class="token punctuation">[</span><span class="token number">-1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> Conv<span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token number">128</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">,</span>  <span class="token comment"># 1-P2/4 卷积核的数量 = 128 * wedith = 128*0.5=64        </span>
   <span class="token punctuation">[</span><span class="token number">-1</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> BottleneckCSP<span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token number">128</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">,</span>       模块数量 = 3 * depth =3<span class="token important">*0.33=1</span>  
   <span class="token punctuation">[</span><span class="token number">-1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> Conv<span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token number">256</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">,</span>  <span class="token comment"># 3-P3/8     </span>
   <span class="token punctuation">[</span><span class="token number">-1</span><span class="token punctuation">,</span> <span class="token number">9</span><span class="token punctuation">,</span> BottleneckCSP<span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token number">256</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">,</span>       模块数量 = 9 * depth =9<span class="token important">*0.33=3</span>  
   <span class="token punctuation">[</span><span class="token number">-1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> Conv<span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token number">512</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">,</span>  <span class="token comment"># 5-P4/16      </span>
   <span class="token punctuation">[</span><span class="token number">-1</span><span class="token punctuation">,</span> <span class="token number">9</span><span class="token punctuation">,</span> BottleneckCSP<span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token number">512</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">,</span>  
   <span class="token punctuation">[</span><span class="token number">-1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> Conv<span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token number">1024</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">,</span>  <span class="token comment"># 7-P5/32      </span>
   <span class="token punctuation">[</span><span class="token number">-1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> SPP<span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token number">1024</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">9</span><span class="token punctuation">,</span> <span class="token number">13</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">,</span>  
   <span class="token punctuation">[</span><span class="token number">-1</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> BottleneckCSP<span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token number">1024</span><span class="token punctuation">,</span> <span class="token boolean important">False</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">,</span>  <span class="token comment"># 9  </span>
  <span class="token punctuation">]</span>  
</code></pre></div><ul><li><p><code>Focus</code>：对特征图的切片操作，模块参数args分析： [[-1, 1, Focus, [64, 3]] 中的 [64, 3] 解析得到[3, 32, 3] ，输入为3（RGB），输出为64<em>0.5 = 32，3是卷积核 3</em>3</p></li> <li><p><code>Conv</code>：这里的Conv由conv+Bn+Leaky_relu激活函数三者组成，模块参数args分析：[-1, 1, Conv, [128, 3, 2]]中的128 是卷积核数量，最终数量需要乘上width = 128 <em>0.5 = 64，3是卷积核 3</em>3，2是步长。</p></li> <li><p><code>BottleneckCSP</code>：借鉴CSPNet网络结构，由三个卷积层和X个Res unint模块Concate组成，如果带有False参数就是没有使用Res unint模块，而是采用conv+Bn+Leaky_relu</p></li> <li><p><code>SPP</code>：采用1×1，5×5，9×9，13×13的最大池化的方式，进行多尺度融合。</p></li></ul> <h4 id="head"><a href="#head" class="header-anchor">#</a> Head</h4> <div class="language-yaml extra-class"><pre class="language-yaml"><code><span class="token comment"># YOLOv5 head  </span>
<span class="token key atrule">head</span><span class="token punctuation">:</span>  
  <span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token number">-1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> Conv<span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token number">512</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">,</span>  
   <span class="token punctuation">[</span><span class="token number">-1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> nn.Upsample<span class="token punctuation">,</span> <span class="token punctuation">[</span>None<span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token string">'nearest'</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">,</span>     上采样  
   <span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token number">-1</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> Concat<span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token comment">#cat backbone P4 [-1, 6]代表cat上一层和第6层  </span>
   <span class="token punctuation">[</span><span class="token number">-1</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> BottleneckCSP<span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token number">512</span><span class="token punctuation">,</span> <span class="token boolean important">False</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">,</span>  <span class="token comment"># 13 第13层        </span>
     
   <span class="token punctuation">[</span><span class="token number">-1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> Conv<span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token number">256</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">,</span>  
   <span class="token punctuation">[</span><span class="token number">-1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> nn.Upsample<span class="token punctuation">,</span> <span class="token punctuation">[</span>None<span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token string">'nearest'</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">,</span>     上采样  
   <span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token number">-1</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> Concat<span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token comment">#cat backbone P3 [-1,4]代表cat上一层和第4层  </span>
   <span class="token punctuation">[</span><span class="token number">-1</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> BottleneckCSP<span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token number">256</span><span class="token punctuation">,</span> <span class="token boolean important">False</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token comment"># 17 (P3/8-small)    第17层  </span>
  
   <span class="token punctuation">[</span><span class="token number">-1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> Conv<span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token number">256</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">,</span>  
   <span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token number">-1</span><span class="token punctuation">,</span> <span class="token number">14</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> Concat<span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token comment">#cat head P4 [-1,14]代表cat上一层和第14层  </span>
   <span class="token punctuation">[</span><span class="token number">-1</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> BottleneckCSP<span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token number">512</span><span class="token punctuation">,</span> <span class="token boolean important">False</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">,</span>  <span class="token comment"># 20 (P4/16-medium)  第20层  </span>
  
   <span class="token punctuation">[</span><span class="token number">-1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> Conv<span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token number">512</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">,</span>                       
   <span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token number">-1</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> Concat<span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token comment">#cat head P5 [-1,10]代表cat上一层和第10层  </span>
   <span class="token punctuation">[</span><span class="token number">-1</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> BottleneckCSP<span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token number">1024</span><span class="token punctuation">,</span> <span class="token boolean important">False</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">,</span>  <span class="token comment"># 23 (P5/32-large)  第23层  </span>
     
   <span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token number">17</span><span class="token punctuation">,</span> <span class="token number">20</span><span class="token punctuation">,</span> <span class="token number">23</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> Detect<span class="token punctuation">,</span> <span class="token punctuation">[</span>nc<span class="token punctuation">,</span> anchors<span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token comment"># Detect(P3, P4, P5)  </span>
  <span class="token punctuation">]</span><span class="token comment">#Detect [17, 20, 23] 代表输入的层数17和20和23  </span>
</code></pre></div><p>Yolov5 Head 包括 Neck 和 Detector head 两部分，Neck部分使用了PANet的结构， Detector head使用和yolov3一样的head。其中，BottleneckCSP带有False参数说明没有使用Res unit结构而是采用了conv+Bn+Leaky_relu。</p> <h2 id=""><a href="#" class="header-anchor">#</a></h2> <h2 id="模型训练"><a href="#模型训练" class="header-anchor">#</a> 模型训练</h2> <p>为了训练我们的检测器，我们采取以下步骤：</p> <ul><li>安装 YOLOv5 依赖项</li> <li>加载自定义 YOLOv5 数据集</li> <li>定义 YOLOv5 模型配置和架构</li> <li>训练自定义 YOLOv5 检测器</li> <li>评估 YOLOv5 性能</li> <li>可视化 YOLOv5 训练数据</li> <li>在测试图像上运行 YOLOv5 推理</li> <li>导出保存的 YOLOv5 权重以供将来推理</li></ul> <h3 id="step01-安装-yolov5-依赖项"><a href="#step01-安装-yolov5-依赖项" class="header-anchor">#</a> Step01-安装 YOLOv5 依赖项</h3> <p>要从 YOLOv5 开始，我们首先克隆 YOLOv5 存储库并安装依赖项。</p> <div class="language-python extra-class"><pre class="language-python"><code>!git clone https<span class="token punctuation">:</span><span class="token operator">//</span>github<span class="token punctuation">.</span>com<span class="token operator">/</span>ultralytics<span class="token operator">/</span>yolov5  <span class="token comment"># clone repo</span>
<span class="token operator">%</span>cd yolov5
</code></pre></div><p><img src="http://test-123-imagebed.oss-cn-beijing.aliyuncs.com/img/image-20210702201537419.png" alt="image-20210702201537419"></p> <p>安装依赖环境和wandb包。wandb现在与YOLOv5集成，用于训练运行的实时可视化和云记录，具体可以查看<a href="https://wandb.ai/cayush/yolov5-dsviz-demo/reports/Object-Detection-with-YOLO-and-Weights-Biases--Vmlldzo0NTgzMjk" target="_blank" rel="noopener noreferrer">wandb官网的介绍</a>和Yolov5对其的介绍：<a href="https://github.com/ultralytics/yolov5/issues/1289" target="_blank" rel="noopener noreferrer">Weights &amp; Biases with YOLOv5 🌟 #1289</a></p> <div class="language-python extra-class"><pre class="language-python"><code>!pip install <span class="token operator">-</span>r requirements<span class="token punctuation">.</span>txt
!pip install wandb
</code></pre></div><p>然后，我们可以看看我们从 Google Colab 免费提供给我们的训练环境。</p> <div class="language-python extra-class"><pre class="language-python"><code><span class="token comment">#查看torch版本和gpu</span>
<span class="token keyword">import</span> torch
<span class="token keyword">from</span> IPython<span class="token punctuation">.</span>display <span class="token keyword">import</span> Image<span class="token punctuation">,</span> clear_output  <span class="token comment"># to display images</span>

clear_output<span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f&quot;Setup complete. Using torch </span><span class="token interpolation"><span class="token punctuation">{</span>torch<span class="token punctuation">.</span>__version__<span class="token punctuation">}</span></span><span class="token string"> (</span><span class="token interpolation"><span class="token punctuation">{</span>torch<span class="token punctuation">.</span>cuda<span class="token punctuation">.</span>get_device_properties<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">.</span>name <span class="token keyword">if</span> torch<span class="token punctuation">.</span>cuda<span class="token punctuation">.</span>is_available<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">else</span> <span class="token string">'CPU'</span><span class="token punctuation">}</span></span><span class="token string">)&quot;</span></span><span class="token punctuation">)</span>

<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">:</span>Setup complete<span class="token punctuation">.</span> Using torch <span class="token number">1.9</span><span class="token number">.0</span><span class="token operator">+</span>cu102 <span class="token punctuation">(</span>Tesla T4<span class="token punctuation">)</span>
</code></pre></div><p>根据<a href="https://cloud.google.com/blog/products/ai-machine-learning/nvidia-tesla-t4-gpus-now-available-in-beta" target="_blank" rel="noopener noreferrer">Google官网</a>显示，colab的T4应该只在部分地区开放，我这里用的是东京的ip来白嫖。</p> <img src="http://test-123-imagebed.oss-cn-beijing.aliyuncs.com/img/T4_Regional_Availability.max-2200x2200.png" alt="gcp_nvidia_t4.png" style="zoom:50%;"> <p>之后我们测试是否安装成功</p> <div class="language-python extra-class"><pre class="language-python"><code><span class="token comment">#使用官方数据进行测试</span>
!python detect<span class="token punctuation">.</span>py <span class="token operator">-</span><span class="token operator">-</span>weights yolov5s<span class="token punctuation">.</span>pt <span class="token operator">-</span><span class="token operator">-</span>img <span class="token number">640</span> <span class="token operator">-</span><span class="token operator">-</span>conf <span class="token number">0.25</span> <span class="token operator">-</span><span class="token operator">-</span>source data<span class="token operator">/</span>images
<span class="token comment">#需要注意路径，一般而言每运行一次都会新建一个exp</span>
Image<span class="token punctuation">(</span>filename<span class="token operator">=</span><span class="token string">'runs/detect/exp/zidane.jpg'</span><span class="token punctuation">,</span> width<span class="token operator">=</span><span class="token number">600</span><span class="token punctuation">)</span>
</code></pre></div><h3 id="step02-加载自定义-yolov5-数据集"><a href="#step02-加载自定义-yolov5-数据集" class="header-anchor">#</a> Step02-加载自定义 YOLOv5 数据集</h3> <p>因为数据集不是很大，我这里最开始使用的google drive上传数据集的模式。</p> <p><img src="http://test-123-imagebed.oss-cn-beijing.aliyuncs.com/img/image-20210702225219971.png" alt="image-20210702225219971"></p> <p>目前colab已经默认挂载google网盘，放置在<code>/drive/</code>文件夹，因此我们直接解压就好</p> <div class="language-python extra-class"><pre class="language-python"><code>!unzip <span class="token operator">-</span>uq <span class="token operator">/</span>content<span class="token operator">/</span>drive<span class="token operator">/</span>MyDrive<span class="token operator">/</span>Yolov5_gw<span class="token operator">-</span>detct_colab<span class="token operator">/</span>Yolov5_gw_dataset<span class="token punctuation">.</span><span class="token builtin">zip</span> <span class="token operator">-</span>d Yolov5_gw_dataset 
<span class="token comment">#现在是在yolov5文件夹内，所以直接解压到当前文件夹</span>
</code></pre></div><p><img src="http://test-123-imagebed.oss-cn-beijing.aliyuncs.com/img/image-20210701203347221.png" alt="image-20210701203347221"></p> <h3 id="step03-定义-yolov5-模型配置和架构"><a href="#step03-定义-yolov5-模型配置和架构" class="header-anchor">#</a> Step03-定义 YOLOv5 模型配置和架构</h3> <p>训练COCO数据集或者是VOC数据集，可以直接使用已经配置好的<code>coco.yaml</code> 和 <code>voc.yaml</code>文件。如果训练别的数据集，则需要模仿coco.yaml 文件写一个自己的<code>.yaml</code>文件保存在data文件夹下。我们创建数据集的配置文件<code>gw_detect.yaml</code>，指定了数据集的位置和分类信息。</p> <div class="language-yaml extra-class"><pre class="language-yaml"><code><span class="token comment"># train and val data as 1) directory: path/images/, 2) file: path/images.txt, or 3) list: [path1/images/, path2/images/]</span>
<span class="token comment">#训练和验证集的路径</span>
<span class="token key atrule">train</span><span class="token punctuation">:</span> ./Yolov5_gw_dataset/images/train/
<span class="token key atrule">val</span><span class="token punctuation">:</span> ./Yolov5_gw_dataset/images/val/

<span class="token comment"># 类别数目</span>
<span class="token key atrule">nc</span><span class="token punctuation">:</span> <span class="token number">2</span>

<span class="token comment"># 类别名字</span>
<span class="token key atrule">names</span><span class="token punctuation">:</span> <span class="token punctuation">[</span> <span class="token string">'gun'</span><span class="token punctuation">,</span> <span class="token string">'sword'</span> <span class="token punctuation">]</span>
</code></pre></div><p>同样的我们将它上传到谷歌网盘，然后在colab使用。</p> <h3 id="step04-训练-yolov5-检测器"><a href="#step04-训练-yolov5-检测器" class="header-anchor">#</a> Step04-训练 YOLOv5 检测器</h3> <p>我们设置完<code>gw_detect.yaml</code>后，就可以通过运行Yolov5目录下的<code>train.py</code>开始训练模型。训练配置可以通过命令行运行<code>train.py</code>的方式输入。相关参数可以查看<code>train.py</code>，也有博客对其进行了介绍：<a href="https://blog.csdn.net/Q1u1NG/article/details/107463417" target="_blank" rel="noopener noreferrer">YOLOV5训练代码train.py注释与解析</a>。</p> <p>为了开始训练，我们使用以下选项运行训练命令：</p> <ul><li><code>--img</code>：定义输入图像大小</li> <li><code>--epochs</code>：迭代轮次，这里设置为500</li> <li><code>--batch-size</code>：硬件不好的话，把16改为8或者4甚至更低（yolov5支持更小，这里白嫖的是colab的tesla T4，就直接16了）</li> <li><code>--weights</code>：可以不加载预训练模型，这里改成无，当然也可以加载，这里使用yolov5s，具体模型选取看yolov5官方仓库的数据（也可以加载云盘中训练好的模型权重）</li> <li><code>--data</code>：指定配置文件的位置</li> <li><code>--cache</code>：缓存图像以加快训练速度</li> <li><code>--upload_dataset</code>：wandb中的参数，在模型训练时将数据集作为DSViz表上传wandb，后续可以云端分享和读取
<ul><li>If the dataset is logged in you W&amp;B dasboard, you get training progress artifacts which compares the predictions from each epoch with their ground truths（如果数据集记录在你的W&amp;B数据板上，你会得到训练进度工件，它将每个历元的预测与它们的基本事实进行比较）</li></ul></li> <li><code>--save_preiod</code>：设置在将模型检查点记录为工件之前要等待的epoch数。如果未设置，则只记录最终训练的模型）</li></ul> <div class="language-python extra-class"><pre class="language-python"><code>!python train<span class="token punctuation">.</span>py \
  <span class="token operator">-</span><span class="token operator">-</span>img <span class="token number">640</span> \
  <span class="token operator">-</span><span class="token operator">-</span>batch <span class="token number">16</span>  \
  <span class="token operator">-</span><span class="token operator">-</span>epochs <span class="token number">500</span>  \
  <span class="token operator">-</span><span class="token operator">-</span>data <span class="token operator">/</span>content<span class="token operator">/</span>drive<span class="token operator">/</span>MyDrive<span class="token operator">/</span>Yolov5_gw<span class="token operator">-</span>detct_colab<span class="token operator">/</span>gw_data<span class="token punctuation">.</span>yaml \
  <span class="token operator">-</span><span class="token operator">-</span>weights yolov5s<span class="token punctuation">.</span>pt  \
  <span class="token operator">-</span><span class="token operator">-</span>project Yolo<span class="token operator">-</span>wandb<span class="token operator">-</span>gw<span class="token operator">-</span>detect \
  <span class="token operator">-</span><span class="token operator">-</span>upload_dataset \
  <span class="token operator">-</span><span class="token operator">-</span>save_period <span class="token number">50</span> \
  <span class="token operator">-</span><span class="token operator">-</span>cache 
</code></pre></div><p>接着就开始训练了，由于我们使用了wandb作为网络模型可视化，这里会弹出让我们填写api key的选项，点击链接进行填写就行。</p> <p><img src="http://test-123-imagebed.oss-cn-beijing.aliyuncs.com/img/image-20210702200510369.png" alt="image-20210702200510369"></p> <p><img src="http://test-123-imagebed.oss-cn-beijing.aliyuncs.com/img/image-20210702200608586.png" alt="image-20210702200608586"></p> <p>点击进去我们可以看到模型的相关运行效果、机器的内存占用数。其中wandb项目可以进行云端分享和读取</p> <p><img src="http://test-123-imagebed.oss-cn-beijing.aliyuncs.com/img/image-20210702204237805.png" alt="image-20210702204237805"></p> <p>此外wandb允许我们可以通过复制run path参数进行中断后的运行（可以异地运行）。具体可以查看wandb官方的<a href="https://colab.research.google.com/drive/1CRC7kxYTIQQysowbrT2L6ctPen6ZQVeN?usp=sharing" target="_blank" rel="noopener noreferrer">colab笔记本</a>。</p> <div class="language-python extra-class"><pre class="language-python"><code>!python train<span class="token punctuation">.</span>py <span class="token operator">-</span><span class="token operator">-</span>resume wandb<span class="token operator">-</span>artifact<span class="token punctuation">:</span><span class="token operator">//</span><span class="token punctuation">{</span>insert run path of crashed run<span class="token punctuation">}</span>
</code></pre></div><p>经过半个多小时，500个epoch跑完（比用K80快了十几分钟）</p> <p><img src="http://test-123-imagebed.oss-cn-beijing.aliyuncs.com/img/image-20210702223125631.png" alt="image-20210702223125631"></p> <ul><li><code>last.pt</code>是最近一次迭代的模型</li> <li><code>best.pt</code>是最好效果的模型</li></ul> <h3 id="step05-评估自定义-yolov5-检测器性能"><a href="#step05-评估自定义-yolov5-检测器性能" class="header-anchor">#</a> Step05-评估自定义 YOLOv5 检测器性能</h3> <p>现在我们已经完成了训练，我们可以通过查看验证指标来评估训练过程的执行情况。</p> <p>最简单的方法是点击wandb的网页显示，直接查看wandb生成的结果图。</p> <p><img src="http://test-123-imagebed.oss-cn-beijing.aliyuncs.com/img/image-20210702211656117.png" alt="image-20210702211656117"></p> <p>在jupyter中，可以直接读取<code>/results.png</code>文件</p> <div class="language-python extra-class"><pre class="language-python"><code><span class="token triple-quoted-string string">'''
如果要做图的话，可以参考官方colab
from utils.plots import plot_results 
plot_results(save_dir='runs/train/exp')  # plot all results*.txt files in 'runs/train/exp' 
# 'runs/train/exp'为运行文件目录，如果第二次运行，就是存放在exp2，要相应地进行修改
Image(filename='runs/train/exp/results.png', width=800)
'''</span>
<span class="token comment">#这里wandb已经帮我作图了，直接读取就好</span>
Image<span class="token punctuation">(</span>filename<span class="token operator">=</span><span class="token string">'Yolo-wandb-gw-detect/exp/results.png'</span><span class="token punctuation">,</span> width<span class="token operator">=</span><span class="token number">800</span><span class="token punctuation">)</span>
</code></pre></div><p><img src="http://test-123-imagebed.oss-cn-beijing.aliyuncs.com/img/result.png" alt="result"></p> <h3 id="step06-可视化-yolov5-训练数据"><a href="#step06-可视化-yolov5-训练数据" class="header-anchor">#</a> Step06-可视化 YOLOv5 训练数据</h3> <p>在训练期间，YOLOv5 训练管道通过增强创建了一批训练数据。我们可以可视化训练数据的真实情况以及增强的训练数据</p> <h3 id="step07-在测试图像上运行-yolov5-推理"><a href="#step07-在测试图像上运行-yolov5-推理" class="header-anchor">#</a> Step07-在测试图像上运行 YOLOv5 推理</h3> <p>现在我们使用我们训练好的模型并对测试图像进行推断。训练完成后，模型权重将保存在<code>weights/</code>。</p> <p>对于推理，我们调用这些权重以及<code>--conf</code>指定的模型置信度（所需的置信度越高，预测越少）。</p> <p>通过<code>source</code>来指定输入文件目录 。<code>source</code>可以接受图像目录、单个图像、视频文件以及设备的网络摄像头端口。</p> <div class="language-python extra-class"><pre class="language-python"><code>!python detect<span class="token punctuation">.</span>py 
	<span class="token operator">-</span><span class="token operator">-</span>weights Yolo<span class="token operator">-</span>wandb<span class="token operator">-</span>gw<span class="token operator">-</span>detect<span class="token operator">/</span>exp<span class="token operator">/</span>weights<span class="token operator">/</span>best<span class="token punctuation">.</span>pt \
    <span class="token operator">-</span><span class="token operator">-</span>img <span class="token number">416</span> \
    <span class="token operator">-</span><span class="token operator">-</span>conf <span class="token number">0.4</span> \
    <span class="token operator">-</span><span class="token operator">-</span>source <span class="token operator">/</span>content<span class="token operator">/</span>drive<span class="token operator">/</span>MyDrive<span class="token operator">/</span>Yolov5_gw<span class="token operator">-</span>detct_colab<span class="token operator">/</span>gw_test_image<span class="token operator">/</span>fig_sword_01<span class="token punctuation">.</span>jpg
</code></pre></div><p>在这里我们使用网盘中的<code>Yolov5_gw-detct_colab/gw_test_image/fig_sword_01.jpg</code>进行测试</p> <p><img src="http://test-123-imagebed.oss-cn-beijing.aliyuncs.com/img/image-20210702224615976.png" alt="image-20210702224615976"></p> <p>可以看到在T4上只用了0.307s检测</p> <p>由于已经运行过一次测试集（最开始测试yolov5安装是否成功的图片），所以这次检测测试输出在<code>exp2</code>文件夹。</p> <div class="language-python extra-class"><pre class="language-python"><code>Image<span class="token punctuation">(</span>filename<span class="token operator">=</span><span class="token string">'/content/yolov5/runs/detect/exp2/fig_sword_01.jpg'</span><span class="token punctuation">,</span>width<span class="token operator">=</span><span class="token number">900</span><span class="token punctuation">)</span>
</code></pre></div><p>看起来检测效果还行。</p> <p><img src="http://test-123-imagebed.oss-cn-beijing.aliyuncs.com/img/image-20210702224458443.png" alt="image-20210702224458443"></p> <p>把测试文件夹的其他图片也检测了</p> <div class="language-python extra-class"><pre class="language-python"><code><span class="token comment">#干脆全部检测一遍</span>
!python detect<span class="token punctuation">.</span>py 
  <span class="token operator">-</span><span class="token operator">-</span>weights Yolo<span class="token operator">-</span>wandb<span class="token operator">-</span>gw<span class="token operator">-</span>detect<span class="token operator">/</span>exp<span class="token operator">/</span>weights<span class="token operator">/</span>best<span class="token punctuation">.</span>pt \
  <span class="token operator">-</span><span class="token operator">-</span>img <span class="token number">416</span> \
  <span class="token operator">-</span><span class="token operator">-</span>conf <span class="token number">0.4</span> \
  <span class="token operator">-</span><span class="token operator">-</span>source <span class="token operator">/</span>content<span class="token operator">/</span>drive<span class="token operator">/</span>MyDrive<span class="token operator">/</span>Yolov5_gw<span class="token operator">-</span>detct_colab<span class="token operator">/</span>gw_test_image<span class="token operator">/</span>
</code></pre></div><p>七张图片共用时2.632s</p> <p><img src="http://test-123-imagebed.oss-cn-beijing.aliyuncs.com/img/image-20210702224742448.png" alt="image-20210702224742448"></p> <h3 id="step08-导出保存的-yolov5-权重以供将来推理"><a href="#step08-导出保存的-yolov5-权重以供将来推理" class="header-anchor">#</a> Step08-导出保存的 YOLOv5 权重以供将来推理</h3> <p>主要的文件就是weights文件夹下的best.pt，由于是在colab运行的，所以可以直接点击下载进行保存，也可以保存到google云盘方便后续直接读取使用【备注：Yolov5是允许通过加载谷歌云盘上的模型作为预训练模型】</p> <div class="language-python extra-class"><pre class="language-python"><code><span class="token operator">%</span>cp <span class="token operator">/</span>content<span class="token operator">/</span>yolov5<span class="token operator">/</span>Yolo<span class="token operator">-</span>wandb<span class="token operator">-</span>gw<span class="token operator">-</span>detect<span class="token operator">/</span>exp<span class="token operator">/</span>weights<span class="token operator">/</span>best<span class="token punctuation">.</span>pt <span class="token operator">/</span>content<span class="token operator">/</span>drive<span class="token operator">/</span>My\ Drive<span class="token operator">/</span>Yolov5_gw<span class="token operator">-</span>detect_colab
</code></pre></div><p>自从Yolov5模型训练的工作大体结束。</p> <h2 id="stepx-优化和部署模型-可选"><a href="#stepx-优化和部署模型-可选" class="header-anchor">#</a> StepX-优化和部署模型（可选）</h2> <p>由于Yolov5是通过pytorch使用的，所以也可以视为pytorch模型转化为TensorRT</p> <p>具体可以参考：</p> <p><a href="https://zhuanlan.zhihu.com/p/365191541" target="_blank" rel="noopener noreferrer">知乎：手把手教你使用yolov5训练自己的数据集并用TensorRT加速</a></p> <p><a href="https://zhuanlan.zhihu.com/p/88318324" target="_blank" rel="noopener noreferrer">知乎：如何使用TensorRT对训练好的PyTorch模型进行加速?</a></p> <p>[<a href="https://github.com/wang-xinyu/tensorrtx" target="_blank" rel="noopener noreferrer">tensorrtx</a>/<strong>yolov5</strong>/](https://github.com/wang-xinyu/tensorrtx/tree/master/yolov5)</p> <h2 id="stepy-形成报告"><a href="#stepy-形成报告" class="header-anchor">#</a> StepY-形成报告</h2> <p>得益于我们绑定了wandb进行可视化，我们可以利用wandb形成我们所需的报告（支持<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>L</mi><mi>a</mi><mi>t</mi><mi>e</mi><mi>x</mi></mrow><annotation encoding="application/x-tex">Latex</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathnormal">L</span><span class="mord mathnormal">a</span><span class="mord mathnormal">t</span><span class="mord mathnormal">e</span><span class="mord mathnormal">x</span></span></span></span>和markdown语言）。只要进入自己的wandb界面就可以看到项目，点击进去右上角就有导出报告选项。</p> <img src="http://test-123-imagebed.oss-cn-beijing.aliyuncs.com/img/image-20210703223701856.png" alt="image-20210703223701856" style="zoom:50%;"> <p>这些图可以在项目界面进行预览</p> <img src="http://test-123-imagebed.oss-cn-beijing.aliyuncs.com/img/image-20210703223802793.png" alt="image-20210703223802793" style="zoom:50%;"> <p>形成的报告可以分享给别人，项目也可以邀请他人协作。</p> <p>该项目的wandb形成报告：https://wandb.ai/chancey/yolo-wandb-gw-detect/reports/Copy-of-chancey-s---Vmlldzo4MjE1OTA/</p> <p>wandb地址：https://wandb.ai/chancey/yolo-wandb-gw-detect/overview?workspace=user-chancey</p> <h2 id="结果"><a href="#结果" class="header-anchor">#</a> 结果</h2> <p><img src="http://test-123-imagebed.oss-cn-beijing.aliyuncs.com/img/result.png" alt="result"></p> <p><img src="http://test-123-imagebed.oss-cn-beijing.aliyuncs.com/img/image-20210703224231700.png" alt="image-20210703224231700"></p> <p><img src="http://test-123-imagebed.oss-cn-beijing.aliyuncs.com/img/image-20210703224223085.png" alt="image-20210703224223085"></p> <h2 id="补充材料"><a href="#补充材料" class="header-anchor">#</a> 补充材料</h2> <h3 id="其他项目补充"><a href="#其他项目补充" class="header-anchor">#</a> 其他项目补充</h3> <p><a href="https://towardsdatascience.com/how-to-track-football-players-using-yolo-sort-and-opencv-6c58f71120b8" target="_blank" rel="noopener noreferrer">如何使用 Yolo、SORT 和 Opencv 跟踪足球运动员</a></p> <p>检测王者荣耀中的英雄小兵野怪等<a href="https://colab.research.google.com/drive/1D9LkkNgmQ1sZxCxnJrfJEyXGf25-Gdxu?usp=sharing" target="_blank" rel="noopener noreferrer"><img src="http://test-123-imagebed.oss-cn-beijing.aliyuncs.com/img/image-20210703223053458.png" alt="image-20210703223053458"></a>【数据集来源于b站用户的<a href="https://www.bilibili.com/video/BV1fN41197r8?from=search&amp;seid=2951274229628230627" target="_blank" rel="noopener noreferrer">分享</a>，可以阅读腾讯的文献<a href="https://arxiv.org/abs/1907.07854" target="_blank" rel="noopener noreferrer"><strong>Understanding Video Content: Efficient Hero Detection and Recognition for the Game &quot;Honor of Kings&quot;</strong></a>，基于yolo框架用更细致的数据处理，可以区分敌我和精彩时刻，腾讯云上的<a href="https://cloud.tencent.com/developer/article/1121706" target="_blank" rel="noopener noreferrer">解读</a>）</p> <p><img src="http://test-123-imagebed.oss-cn-beijing.aliyuncs.com/img/image-20210703215954771.png" alt="image-20210703215954771"></p></div> <footer class="page-edit"><div class="edit-link"><a href="https://github.com/chancey922/chancey922.github.io/edit/main/blog/posts/2021-07-04-基于Colab+yolov5.md" target="_blank" rel="noopener noreferrer"><svg aria-hidden="true" width="19.2" height="19.2" viewBox="-43.52 -43.52 599.04 599.04" fill="currentColor" class="ov-icon" style="font-size:1.2em;"><path d="M497.9 142.1l-46.1 46.1c-4.7 4.7-12.3 4.7-17 0l-111-111c-4.7-4.7-4.7-12.3 0-17l46.1-46.1c18.7-18.7 49.1-18.7 67.9 0l60.1 60.1c18.8 18.7 18.8 49.1 0 67.9zM284.2 99.8L21.6 362.4.4 483.9c-2.9 16.4 11.4 30.6 27.8 27.8l121.5-21.3 262.6-262.6c4.7-4.7 4.7-12.3 0-17l-111-111c-4.8-4.7-12.4-4.7-17.1 0zM124.1 339.9c-5.5-5.5-5.5-14.3 0-19.8l154-154c5.5-5.5 14.3-5.5 19.8 0s5.5 14.3 0 19.8l-154 154c-5.5 5.5-14.3 5.5-19.8 0zM88 424h48v36.3l-64.5 11.3-31.1-31.1L51.7 376H88v48z"/></svg>
      Edit this page on GitHub
    </a></div> <!----></footer> <!----> <div class="pager"><a href="/post/2021/07/14/tgca/" class="next">
    Next<br> <span>
      文献阅读
    </span></a> <a href="/post/2021/07/03/%E5%9F%BA%E4%BA%8Eresnet%E7%9A%84%E7%8C%AB%E7%8B%97%E5%88%86%E7%B1%BB/" class="previous">
    Previous<br> <span>
      迁移学习的应用
    </span></a></div> <!----></main> <ul class="catalog-wrapper" style="top:0px !important;" data-v-35c58a2e><li class="level-2 toc-link-任务概述" data-v-35c58a2e>任务概述</li><li class="level-2 toc-link-选择模型" data-v-35c58a2e>选择模型</li><li class="level-2 toc-link-配置环境" data-v-35c58a2e>配置环境</li><li class="level-2 toc-link-数据收集" data-v-35c58a2e>数据收集</li><li class="level-3 toc-link-yolov5的数据格式要求" data-v-35c58a2e>Yolov5的数据格式要求</li><li class="level-4 toc-link-单个数据" data-v-35c58a2e>单个数据</li><li class="level-4 toc-link-数据集" data-v-35c58a2e>数据集</li><li class="level-2 toc-link-yolov5的配置文件yaml" data-v-35c58a2e>yolov5的配置文件yaml</li><li class="level-3 toc-link-yaml里有什么" data-v-35c58a2e>yaml里有什么</li><li class="level-4 toc-link-parameters" data-v-35c58a2e>parameters</li><li class="level-4 toc-link-acnhor" data-v-35c58a2e>Acnhor</li><li class="level-4 toc-link-backbone" data-v-35c58a2e>Backbone</li><li class="level-4 toc-link-head" data-v-35c58a2e>Head</li><li class="active level-2 toc-link-" data-v-35c58a2e></li><li class="level-2 toc-link-模型训练" data-v-35c58a2e>模型训练</li><li class="level-3 toc-link-step01-安装-yolov5-依赖项" data-v-35c58a2e>Step01-安装 YOLOv5 依赖项</li><li class="level-3 toc-link-step02-加载自定义-yolov5-数据集" data-v-35c58a2e>Step02-加载自定义 YOLOv5 数据集</li><li class="level-3 toc-link-step03-定义-yolov5-模型配置和架构" data-v-35c58a2e>Step03-定义 YOLOv5 模型配置和架构</li><li class="level-3 toc-link-step04-训练-yolov5-检测器" data-v-35c58a2e>Step04-训练 YOLOv5 检测器</li><li class="level-3 toc-link-step05-评估自定义-yolov5-检测器性能" data-v-35c58a2e>Step05-评估自定义 YOLOv5 检测器性能</li><li class="level-3 toc-link-step06-可视化-yolov5-训练数据" data-v-35c58a2e>Step06-可视化 YOLOv5 训练数据</li><li class="level-3 toc-link-step07-在测试图像上运行-yolov5-推理" data-v-35c58a2e>Step07-在测试图像上运行 YOLOv5 推理</li><li class="level-3 toc-link-step08-导出保存的-yolov5-权重以供将来推理" data-v-35c58a2e>Step08-导出保存的 YOLOv5 权重以供将来推理</li><li class="level-2 toc-link-stepx-优化和部署模型-可选" data-v-35c58a2e>StepX-优化和部署模型（可选）</li><li class="level-2 toc-link-stepy-形成报告" data-v-35c58a2e>StepY-形成报告</li><li class="level-2 toc-link-结果" data-v-35c58a2e>结果</li><li class="level-2 toc-link-补充材料" data-v-35c58a2e>补充材料</li><li class="level-3 toc-link-其他项目补充" data-v-35c58a2e>其他项目补充</li></ul></div> <div class="search-page" data-v-422e6324><span class="search-close"><svg aria-hidden="true" width="34.56" height="34.56" viewBox="-75.52 -43.52 599.04 599.04" fill="currentColor" class="ov-icon" style="font-size:2.16em;"><path d="M207.029 381.476L12.686 187.132c-9.373-9.373-9.373-24.569 0-33.941l22.667-22.667c9.357-9.357 24.522-9.375 33.901-.04L224 284.505l154.745-154.021c9.379-9.335 24.544-9.317 33.901.04l22.667 22.667c9.373 9.373 9.373 24.569 0 33.941L240.971 381.476c-9.373 9.372-24.569 9.372-33.942 0z"/></svg></span> <div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div></div> <div class="menu-btn-container" data-v-413dbfb4 data-v-422e6324><div class="menu-btn-wrapper" data-v-413dbfb4><div class="menu-btn" data-v-413dbfb4><div class="menu-btn-icon" style="display:;" data-v-413dbfb4><span data-v-413dbfb4></span> <span data-v-413dbfb4></span> <span data-v-413dbfb4></span></div> <div class="menu-text" style="display:none;" data-v-413dbfb4>
        0
      </div> <svg class="menu-svg" data-v-413dbfb4><circle cx="50%" cy="50%" r="48%" class="menu-border" style="stroke-dasharray:0% 314.15926%;" data-v-413dbfb4></circle></svg></div> <div class="menu-btn-child-wrapper" data-v-413dbfb4><a role="button" aria-label="Toggle light" title="Toggle light" class="toggle-mode menu-btn-child" data-v-413dbfb4><svg aria-hidden="true" width="19.2" height="19.2" viewBox="-43.52 -43.52 599.04 599.04" fill="currentColor" class="ov-icon" style="font-size:1.2em;"><path d="M224 96l16-32 32-16-32-16-16-32-16 32-32 16 32 16 16 32zM80 160l26.66-53.33L160 80l-53.34-26.67L80 0 53.34 53.33 0 80l53.34 26.67L80 160zm352 128l-26.66 53.33L352 368l53.34 26.67L432 448l26.66-53.33L512 368l-53.34-26.67L432 288zm70.62-193.77L417.77 9.38C411.53 3.12 403.34 0 395.15 0c-8.19 0-16.38 3.12-22.63 9.38L9.38 372.52c-12.5 12.5-12.5 32.76 0 45.25l84.85 84.85c6.25 6.25 14.44 9.37 22.62 9.37 8.19 0 16.38-3.12 22.63-9.37l363.14-363.15c12.5-12.48 12.5-32.75 0-45.24zM359.45 203.46l-50.91-50.91 86.6-86.6 50.91 50.91-86.6 86.6z"/></svg></a> <div class="menu-btn-child" data-v-413dbfb4><svg aria-hidden="true" width="19.2" height="19.2" viewBox="-75.52 -43.52 599.04 599.04" fill="currentColor" class="ov-icon" style="font-size:1.2em;" data-v-413dbfb4><path d="M207.029 381.476L12.686 187.132c-9.373-9.373-9.373-24.569 0-33.941l22.667-22.667c9.357-9.357 24.522-9.375 33.901-.04L224 284.505l154.745-154.021c9.379-9.335 24.544-9.317 33.901.04l22.667 22.667c9.373 9.373 9.373 24.569 0 33.941L240.971 381.476c-9.373 9.372-24.569 9.372-33.942 0z"/></svg></div> <div class="menu-btn-child" data-v-413dbfb4><svg aria-hidden="true" width="19.2" height="19.2" viewBox="-75.52 -43.52 599.04 599.04" fill="currentColor" class="ov-icon" style="font-size:1.2em;" data-v-413dbfb4><path d="M240.971 130.524l194.343 194.343c9.373 9.373 9.373 24.569 0 33.941l-22.667 22.667c-9.357 9.357-24.522 9.375-33.901.04L224 227.495 69.255 381.516c-9.379 9.335-24.544 9.317-33.901-.04l-22.667-22.667c-9.373-9.373-9.373-24.569 0-33.941L207.03 130.525c9.372-9.373 24.568-9.373 33.941-.001z"/></svg></div> <div class="menu-btn-child menu-toc-btn" data-v-413dbfb4><svg aria-hidden="true" width="19.2" height="19.2" viewBox="-43.52 -43.52 599.04 599.04" fill="currentColor" class="ov-icon" style="font-size:1.2em;" data-v-413dbfb4><path d="M48 48a48 48 0 1048 48 48 48 0 00-48-48zm0 160a48 48 0 1048 48 48 48 0 00-48-48zm0 160a48 48 0 1048 48 48 48 0 00-48-48zm448 16H176a16 16 0 00-16 16v32a16 16 0 0016 16h320a16 16 0 0016-16v-32a16 16 0 00-16-16zm0-320H176a16 16 0 00-16 16v32a16 16 0 0016 16h320a16 16 0 0016-16V80a16 16 0 00-16-16zm0 160H176a16 16 0 00-16 16v32a16 16 0 0016 16h320a16 16 0 0016-16v-32a16 16 0 00-16-16z"/></svg></div> <div class="menu-btn-child menu-btn-sidebar" data-v-413dbfb4><svg aria-hidden="true" width="19.2" height="19.2" viewBox="-1.6 -1.6 19.2 19.2" fill="currentColor" class="ov-icon" style="font-size:1.2em;" data-v-413dbfb4><path d="M14 2a1 1 0 011 1v10a1 1 0 01-1 1H2a1 1 0 01-1-1V3a1 1 0 011-1h12zM2 1a2 2 0 00-2 2v10a2 2 0 002 2h12a2 2 0 002-2V3a2 2 0 00-2-2H2z"/><path d="M3 4a1 1 0 011-1h2a1 1 0 011 1v8a1 1 0 01-1 1H4a1 1 0 01-1-1V4z"/></svg></div></div></div></div> <div class="footer-wrapper footer" data-v-2f609db5 data-v-422e6324><span data-v-2f609db5>
      &copy; <a href="https://github.com/chancey922" target="_blank">Chancey922</a> 2018-2021
      <br>
      Powered by <a href="https://vuepress.vuejs.org" target="_blank">VuePress</a> &
      <a href="https://github.com/Renovamen/vuepress-theme-gungnir" target="_blank">Gungnir</a>
    </span></div></div><div class="global-ui"></div></div>
    <script src="https://cdn.jsdelivr.net/gh/chancey922/chancey922.github.io@main/assets/js/app.5d033b80.js" defer></script><script src="https://cdn.jsdelivr.net/gh/chancey922/chancey922.github.io@main/assets/js/8.a3610609.js" defer></script><script src="https://cdn.jsdelivr.net/gh/chancey922/chancey922.github.io@main/assets/js/1.73ff1d21.js" defer></script><script src="https://cdn.jsdelivr.net/gh/chancey922/chancey922.github.io@main/assets/js/2.da6d4541.js" defer></script><script src="https://cdn.jsdelivr.net/gh/chancey922/chancey922.github.io@main/assets/js/25.1d6056a4.js" defer></script>
  </body>
</html>
